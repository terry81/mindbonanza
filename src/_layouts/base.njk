<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ description or excerpt or 'Mind Bonanza - Your journey to mindfulness and inner peace begins here' }}">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="author" content="{{ author or 'Mind Bonanza Team' }}">
    <meta name="theme-color" content="#6B46C1">
    <title>{{ title }} | Mind Bonanza</title>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.mindbonanza.com{{ page.url | url }}">

    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="{{ 'article' if layout == 'post.njk' else 'website' }}">
    <meta property="og:url" content="https://www.mindbonanza.com{{ page.url | url }}">
    <meta property="og:title" content="{{ title }} | Mind Bonanza">
    <meta property="og:description" content="{{ description or excerpt or 'Mind Bonanza - Your journey to mindfulness and inner peace begins here' }}">
    <meta property="og:site_name" content="Mind Bonanza">
    <meta property="og:locale" content="en_US">
    {% if image %}
    <meta property="og:image" content="{{ image }}?auto=format&fit=crop&w=1200&h=630&q=80">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{{ title }}">
    {% else %}
    <meta property="og:image" content="https://www.mindbonanza.com/assets/og-default.png">
    {% endif %}
    <meta property="fb:page_id" content="mymindbonanza">
    {% if layout == 'post.njk' %}
    <meta property="article:published_time" content="{{ date | dateISO }}">
    <meta property="article:author" content="{{ author or 'Mind Bonanza Team' }}">
    {% if category %}
    <meta property="article:section" content="{{ category }}">
    {% endif %}
    {% if tags %}
    {% for tag in tags %}
    <meta property="article:tag" content="{{ tag }}">
    {% endfor %}
    {% endif %}
    {% endif %}

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@mindbonanza">
    <meta name="twitter:creator" content="@mindbonanza">
    <meta name="twitter:title" content="{{ title }} | Mind Bonanza">
    <meta name="twitter:description" content="{{ description or excerpt or 'Mind Bonanza - Your journey to mindfulness and inner peace begins here' }}">
    {% if image %}
    <meta name="twitter:image" content="{{ image }}?auto=format&fit=crop&w=1200&h=630&q=80">
    <meta name="twitter:image:alt" content="{{ title }}">
    {% else %}
    <meta name="twitter:image" content="https://www.mindbonanza.com/assets/og-default.png">
    {% endif %}

    <!-- Structured Data - Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Mind Bonanza",
        "url": "https://www.mindbonanza.com",
        "logo": "https://www.mindbonanza.com/assets/logo.png",
        "sameAs": [
            "https://www.facebook.com/mymindbonanza"
        ],
        "description": "Your journey to mindfulness and inner peace begins here"
    }
    </script>

    <!-- Structured Data - WebSite with Search -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Mind Bonanza",
        "url": "https://www.mindbonanza.com",
        "description": "Mindfulness, meditation techniques, and mental wellness resources",
        "publisher": {
            "@type": "Organization",
            "name": "Mind Bonanza"
        }
    }
    </script>

    {% if layout == 'post.njk' %}
    <!-- Structured Data - Article -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "{{ title }}",
        "description": "{{ excerpt | striptags | truncate(160) }}",
        "image": "{{ image }}?auto=format&fit=crop&w=1200&h=630&q=80",
        "datePublished": "{{ date | dateISO }}",
        "dateModified": "{{ date | dateISO }}",
        "author": {
            "@type": "Person",
            "name": "{{ author or 'Mind Bonanza Team' }}"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Mind Bonanza",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.mindbonanza.com/assets/logo.png"
            }
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.mindbonanza.com{{ page.url | url }}"
        }
        {% if category %},
        "articleSection": "{{ category }}"
        {% endif %}
        {% if tags %},
        "keywords": "{{ tags | join(', ') }}"
        {% endif %}
    }
    </script>

    <!-- Structured Data - BreadcrumbList -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://www.mindbonanza.com/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Blog",
                "item": "https://www.mindbonanza.com/blog/"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "{{ title }}",
                "item": "https://www.mindbonanza.com{{ page.url | url }}"
            }
        ]
    }
    </script>
    {% endif %}

    <!-- Preconnect to external domains for faster loading -->
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://images.unsplash.com" crossorigin>
    <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>

    <!-- DNS Prefetch for external domains -->
    <link rel="dns-prefetch" href="https://www.facebook.com">

    <!-- Preload critical CSS -->
    <link rel="preload" href="/css/main.css?v=2.0.0" as="style">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KP45H8LNWJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-KP45H8LNWJ');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9036157436023559"
         crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/main.css?v=2.0.0">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    {% include "header.njk" %}

    <main id="main-content">
        {{ content | safe }}
    </main>

    {% include "footer.njk" %}

    <!-- Floating Social Media Button -->
    <div class="floating-social">
        <a href="https://www.facebook.com/mymindbonanza" target="_blank" rel="noopener noreferrer" class="floating-fb-btn" title="Follow us on Facebook">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="white">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
        </a>
    </div>

    <script src="/js/main.js?v=2.0.0" defer></script>

    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('Service Worker registered successfully:', registration.scope);

              // Check for updates
              registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    // New service worker available, reload to activate
                    if (confirm('A new version of Mind Bonanza is available. Reload to update?')) {
                      newWorker.postMessage({ type: 'SKIP_WAITING' });
                      window.location.reload();
                    }
                  }
                });
              });
            })
            .catch(err => console.log('Service Worker registration failed:', err));
        });
      }
    </script>
</body>
</html>

